(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d216c31"],{c49c:function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("div",[t("el-select",{attrs:{placeholder:"分类查看"},model:{value:e.view,callback:function(a){e.view=a},expression:"view"}},e._l(e.classifiedView,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-table",{staticStyle:{width:"98%","margin-left":"1%"},attrs:{data:e.tableData}},[t("el-table-column",{scopedSlots:e._u([{key:"header",fn:function(a){return[t("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.checkall},model:{value:e.checkAll,callback:function(a){e.checkAll=a},expression:"checkAll"}},[e._v("全选 ")])]}},{key:"default",fn:function(a){return[t("el-checkbox",{on:{change:function(a){return e.handleCheckedChange(e.oneCheck)}},model:{value:e.oneCheck[a.$index],callback:function(t){e.$set(e.oneCheck,a.$index,t)},expression:"oneCheck[scope.$index]"}})]}}])}),e._l(e.tableHead,(function(e){return t("el-table-column",{key:e.prop,attrs:{label:e.label,prop:e.prop}})}))],2),t("nextPage",{ref:"nextPage",on:{next:e.nextPage}}),t("br"),t("br"),t("br"),1===e.view?t("div",{staticStyle:{float:"right","margin-right":"5%"}},[t("el-button",{attrs:{type:"success",disabled:e.oneCheck===[]},on:{click:function(a){return e.open("2")}}},[e._v("审批通过")]),t("el-button",{attrs:{type:"warning",disabled:e.oneCheck===[]},on:{click:function(a){return e.open("3")}}},[e._v("审批退回")])],1):e._e()],1)},l=[],o={data:function(){return{isIndeterminate:!1,checkAll:!1,oneCheck:[],view:1,classifiedView:[{label:"待审批需求计划",value:1},{label:"已审批需求计划",value:2}],tableData:[],tableHead:[{label:"需求计划编号",prop:"planId"},{label:"需求计划名称",prop:"planName"},{label:"需求计划类型",prop:"planType"},{label:"审批状态",prop:"approvalState"},{label:"需求部门",prop:"needDepartment"},{label:"需求人员",prop:"needPeoName "},{label:"需求月份",prop:"planMonth"}]}},methods:{updateApprovalPlanNeed:function(e){var a=this;this.$api.updateApprovalPlanNeed(e,(function(e){e.data&&(console.log("刷新"),a.$message({type:"success",message:"审批成功 "}))}))},updateApprovalPlanHead:function(e){var a=this;this.$api.updateApprovalPlanHead(e,(function(e){e.data&&a.$message({type:"success",message:"审批成功 "})}))},open:function(e){var a=this,t=[];this.oneCheck.forEach((function(e,a){!0===e&&t.push(a)})),console.log(t),this.$prompt("请在下方填写","审批意见",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(n){t.forEach((function(t){var l={planId:a.tableData[t].planId,approvalState:localStorage.getItem("grade")===a.$constData.grade.demand?"2"===e?"2":"3":"2"===e?"4":"3"};if("3"===e){var o={planId:a.tableData[t].planId,approvalState:"3",planState:"4"};a.$api.changeState(o,(function(e){}))}localStorage.getItem("grade")===a.$constData.grade.demand?(l.approvalNeed="需求计划员",l.approvalNeedTime=Date.now(),l.approvalNeedRemarks=n.value,l.needState=e,a.updateApprovalPlanNeed(l)):(l.approvalHead="部门主管",l.approvalHeadTime=Date.now(),l.approvalHeadRemarks=n.value,l.headState=e,a.updateApprovalPlanHead(l))}))})).catch((function(){a.$message({type:"info",message:"取消审批"})}))},handleCheckedChange:function(e){this.checkAll=e.every((function(e){return!0===e}));var a=e.filter((function(e){return!0===e}));this.isIndeterminate=a.length>0&&a.length<e.length},checkall:function(e){!0===e&&(this.isIndeterminate=!1);var a=[];this.oneCheck.forEach((function(t,n){a[n]=e})),this.oneCheck=a,console.log(this.oneCheck)},nextPage:function(e){e.headState=localStorage.getItem("grade")===this.$constData.grade.demand?"2":1===this.view?"is null":"is not null",e.approvalState="4",e.needState=localStorage.getItem("grade")===this.$constData.grade.demand?1===this.view?"is null":"is not null":"",this.getApprovalPlan(e)},getApprovalPlan:function(e){var a=this;this.$api.getApprovalPlan(e,(function(e){a.tableData=e.data,a.$refs.nextPage.judge(e.data.length);for(var t=0;t<e.data.length;t++)a.oneCheck[t]=!1}))}},mounted:function(){var e={offset:0,count:10,headState:localStorage.getItem("grade")===this.$constData.grade.demand?"2":1===this.view?"is null":"is not null",approvalState:"4",needState:localStorage.getItem("grade")===this.$constData.grade.demand?1===this.view?"is null":"is not null":""};this.getApprovalPlan(e)},watch:{view:function(){var e={offset:0,count:10,headState:localStorage.getItem("grade")===this.$constData.grade.demand?"2":1===this.view?"is null":"is not null",approvalState:"4",needState:localStorage.getItem("grade")===this.$constData.grade.demand?1===this.view?"is null":"is not null":""};this.getApprovalPlan(e)}}},i=o,c=t("2877"),r=Object(c["a"])(i,n,l,!1,null,null,null);a["default"]=r.exports}}]);
//# sourceMappingURL=chunk-2d216c31.4d4541ab.js.map