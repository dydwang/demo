(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ead2190"],{"0b90":function(t,e,a){"use strict";var r=a("71d7"),n=a.n(r);n.a},"0d88":function(t,e,a){},"40a7":function(t,e,a){"use strict";var r=a("0d88"),n=a.n(r);n.a},"5dd7":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"materialPlan"}},[t.operation?a("title-text",{staticStyle:{"margin-bottom":"20px"},attrs:{text:"采购计划列表",weight:"600",color:"#636569"}}):a("title-text",{staticStyle:{"margin-bottom":"20px"},attrs:{text:"采购计划详情",weight:"600",color:"#636569"}}),a("el-table",{staticStyle:{width:"98%"},attrs:{"row-key":t.getRowKeys,"expand-row-keys":t.expands,data:t.tableData,type:"index"},on:{"expand-change":t.expandSelect}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("el-row",[a("el-col",{attrs:{span:12}},[a("procurePlanState",{attrs:{procureId:t.row.procureId}})],1),a("el-col",{attrs:{span:10}},[a("procurePlanChangeState",{attrs:{procureId:t.row.procureId}})],1)],1)]}}])}),a("el-table-column",{attrs:{label:"计划名称",prop:"procureName"}}),a("el-table-column",{attrs:{label:"计划编码",prop:"procureId"}}),a("el-table-column",{attrs:{label:"制单人",prop:"create"}}),a("el-table-column",{attrs:{label:"制单时间",prop:"createTime"}}),a("el-table-column",{attrs:{label:"采购时间",prop:"procureTime"}}),a("el-table-column",{attrs:{label:"计划状态",prop:"planState"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t.getPlanStateType(e.row.planState),"disable-transitions":""}},[t._v(t._s(t.getPlanState(e.row.planState))+" ")])]}}])}),a("el-table-column",{attrs:{label:"审批状态",prop:"approvalState"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t.getPlanStateType(e.row.approvalState),"disable-transitions":""}},[t._v(t._s(t.getApprovalState(e.row.approvalState))+" ")])]}}])}),a("el-table-column",{attrs:{label:"计划类型",prop:"planType"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.getPlanType(e.row.planType))+" ")]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.operation?a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"text",size:"small"},on:{click:function(a){return t.details(e.row)}}},[t._v(" 打印 ")]):t._e(),t.getPower(e.row)?a("span",["1"===e.row.approvalState&&"4"===e.row.planState?a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"text",size:"small"},on:{click:function(a){return t.goBack(e,"4",null)}}},[t._v(" 提交 ")]):t._e(),"1"===e.row.approvalState||"3"===e.row.approvalState?a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"text",size:"small"},on:{click:function(a){return t.updates(e.row)}}},[t._v(" 修改 ")]):t._e(),"4"===e.row.approvalState?a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"text",size:"small"},on:{click:function(a){return t.goBack(e,"1",null)}}},[t._v(" 撤回 ")]):t._e(),"4"===e.row.planState?a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"text",size:"small"},on:{click:function(a){return t.goBack(e,"1","3")}}},[t._v(" 删除 ")]):t._e()],1):t._e()]}}])})],1)],1)},n=[],l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"card"}},[a("div",{attrs:{id:"title"}},[t._v(" 物资计划修改情况 ")]),a("el-card",[a("el-timeline",{directives:[{name:"show",rawName:"v-show",value:t.activities!==[],expression:"activities!==[]"}]},t._l(t.activities,(function(e,r){return a("el-timeline-item",{key:r,attrs:{placement:"top",icon:"el-icon-more",type:"primary ",timestamp:t.getTime(e.reviseTime)}},[a("span",{staticClass:"title"},[t._v(" "+t._s(e.revise)+"修改物资计划 ")]),a("div",{staticStyle:{color:"#909399","margin-right":"50px","margin-top":"10px"}},[t._v(" "+t._s(e.reviseRemarks)+" ")])])})),1),a("div",{directives:[{name:"show",rawName:"v-show",value:""===t.activities,expression:"activities===''"}],staticClass:"el-icon-s-promotion",staticStyle:{color:"#2ca5ef"}},[t._v("暂无修改情况")])],1)],1)},o=[],i={name:"materialPlanChangeState",props:["procureId"],data:function(){return{activities:[{reviseTime:0xb3a73cf5fad,revise:"李四",reviseRemarks:"很好"},{reviseTime:0xb3a73cf5fad,revise:"李四",reviseRemarks:"很好"}]}},methods:{getTime:function(t){var e=new Date(t),a=e.getFullYear(),r=e.getMonth()+1,n=e.getDate(),l=e.getHours(),o=e.getMinutes(),i=e.getSeconds();return"".concat(a,"-").concat(r,"-").concat(n," ").concat(l,":").concat(o,":").concat(i)}},mounted:function(){var t=this,e={procureId:this.procureId};this.$api.getProcurePlanChangeState(e,(function(e){t.activities=e.data}))}},s=i,c=(a("aea6"),a("2877")),p=Object(c["a"])(s,l,o,!1,null,"1565edbb",null),u=p.exports,d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-timeline",{staticClass:"timeline"},t._l(t.activities,(function(e,r){return a("el-timeline-item",{key:r,attrs:{placement:"top",icon:e.icon,type:e.type,color:t.getColor(r),size:e.size,timestamp:t.approval(r)}},[a("el-card",[a("span",{staticClass:"title"},[t._v(" "+t._s(e.content)+" "),0===r?a("i",{staticClass:"el-icon-success",staticStyle:{color:"#04b3f9"}}):t._e(),t._l(3,(function(e){return e===r?a("span",{key:e},[1===r?a("span",[2===t.materialPlanState[0].headState?a("i",{staticClass:"el-icon-success",staticStyle:{color:"#04b3f9"}}):t._e(),3===t.materialPlanState[0].needState?a("i",{staticClass:"el-icon-error",staticStyle:{color:"#e6a23c"}}):t._e()]):t._e(),2===r?a("span",[2===t.materialPlanState[0].needState?a("i",{staticClass:"el-icon-success",staticStyle:{color:"#04b3f9"}}):t._e(),3===t.materialPlanState[0].needState?a("i",{staticClass:"el-icon-error",staticStyle:{color:"#e6a23c"}}):t._e()]):t._e()]):t._e()})),3===r&&2===t.materialPlanState[0].needState&&2===t.materialPlanState[0].headState?a("i",{staticClass:"el-icon-success",staticStyle:{color:"#04b3f9"}}):t._e()],2),a("p",{staticStyle:{color:"#909399"}},[t._v(" "+t._s(t.getRemarks(r))+" ")])])],1)})),1)},m=[],f={props:["procureId"],data:function(){return{activities:[{content:"创建采购计划",type:"primary",icon:"el-icon-more"},{content:"采购主管审核"},{content:"财务审核"},{content:"审核成功"}],materialPlanState:[{create:"创建人",createTime:12315645,createRemarks:"创建人",approvalHead:"部门主管审核",approvalHeadTime:12354678,headState:2,approvalHeadRemarks:"有问题",approvalNeed:"审核需求计划员",approvalNeedTime:1236457,approvalNeedRemarks:"不错",needState:4,revise:"",reviseTime:12345678,reviseRemarks:"不错不错"}],approvalColor:{succ:"#0bbd87",now:"#e6a23c"},approvalCode:this.$store.state.approvalCode}},methods:{getColor:function(t){var e=this.materialPlanState[0];if(0===t)return"#3692f1";if(1===t){if("2"===e.headState)return this.approvalColor.succ}else if(2===t){if("2"===e.needState)return this.approvalColor.succ}else if(3===t)return"2"===e.needState&&"2"===e.headState?this.approvalColor.succ:""},approval:function(t){var e=this.materialPlanState[0],a=parseInt(e.createTime);return t>this.approvalCode?"":0===t&&null!==e.create?"".concat(this.getTime(a),"   ").concat(e.create):1===t&&null!==e.approvalHead?"".concat(this.getTime(e.approvalHeadTime),"   ").concat(e.approvalHead):2===t&&null!==e.approvalNeed?"".concat(this.getTime(e.approvalNeedTime),"   ").concat(e.approvalNeed):3===t?"":(this.approvalCode=t,"审核中")},getRemarks:function(t){return 0===t?this.materialPlanState.createRemarks:1===t?this.materialPlanState.approvalHeadRemarks:2===t?this.materialPlanState.approvalNeedRemarks:""},getTime:function(t){var e=new Date(parseInt(t)),a=e.getFullYear(),r=e.getMonth()+1,n=e.getDate(),l=e.getHours(),o=e.getMinutes(),i=e.getSeconds();return"".concat(a,"-").concat(r,"-").concat(n," ").concat(l,":").concat(o,":").concat(i)}},mounted:function(){var t=this,e={procureId:this.procureId};this.$api.getProcurePlanState(e,(function(e){t.materialPlanState=e.data}))},create:function(){}},v=f,b=(a("bed8"),Object(c["a"])(v,d,m,!1,null,"9e10fca4",null)),S=b.exports,g={name:"Plan",data:function(){return{reverse:!0,expands:[],getRowKeys:function(t){return t.id}}},props:["operation","tableData"],methods:{getPower:function(t){return"3"!==t.planState&&localStorage.getItem("grade")===this.$constData.grade.procure},getPlanState:function(t){t=parseInt(t);var e="已计划",a="已提交汇总",r="已删除",n="已自由";return 1===t?e:2===t?a:3===t?r:4===t?n:void 0},getApprovalState:function(t){t=parseInt(t);var e="未提交",a="审批通过",r="审批退回",n="审批中";return 1===t?e:2===t?a:3===t?r:4===t?n:void 0},tableId:function(){for(var t in this.tableData)this.tableData[t].id=t},getPlanType:function(t){t=parseInt(t);var e="月计划",a="年计划",r="紧急计划";return 1===t?e:2===t?a:3===t?r:""},expandSelect:function(t,e){this.$store.state.approvalCode=100;var a=this;a.tableId(),e.length?(a.expands=[],t&&a.expands.push(t.id)):a.expands=[]},getPlanStateType:function(t){t=parseInt(t);var e="success",a="info",r="warning";return 1===t?"":2===t?e:3===t?r:4===t?a:void 0},details:function(t){sessionStorage.setItem("producePlan",JSON.stringify(t)),this.$router.push({path:"procurePlanDetails"})},goBack:function(t,e,a){var r=this;this.tableData.splice(t.$index,1);var n={};n.procureId=t.row.procureId,n.approvalState=e,n.planState=null===a?t.row.planState:a,this.$api.procureChangeState(n,(function(n){t.row.approvalState=e,t.row.planState=null===a?t.row.planState:a,r.tableData.splice(t.$index,0,t.row)}))},updates:function(t){sessionStorage.setItem("updateProcurePlan",JSON.stringify(t)),this.$router.push({path:"updateProcure"})}},mounted:function(){},created:function(){},components:{procurePlanChangeState:u,procurePlanState:S}},h=g,y=(a("0b90"),Object(c["a"])(h,r,n,!1,null,"0d55f622",null));e["a"]=y.exports},"71d7":function(t,e,a){},"82f1":function(t,e,a){},a8a1:function(t,e,a){},aea6:function(t,e,a){"use strict";var r=a("a8a1"),n=a.n(r);n.a},bed8:function(t,e,a){"use strict";var r=a("82f1"),n=a.n(r);n.a},ce76:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-button",{staticClass:"icon-ail-biaoge-xiazai",staticStyle:{float:"right","margin-right":"5%"},attrs:{type:"warning",round:""},on:{click:function(e){t.dialogVisible=!0}}},[t._v(" 导 出")]),a("br"),a("br"),a("procePlan",{attrs:{operation:!1,"table-data":t.plan}}),a("div",{staticStyle:{"text-align":"center",margin:"20px auto 10px",color:"#909399","font-weight":"600","font-size":"14px"}},[t._v("物品清单")]),a("list",{staticStyle:{width:"98%","margin-left":"1%"},attrs:{list:t.list}}),a("el-dialog",{attrs:{title:"导出采购计划",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-input",{attrs:{placeholder:"请输入文件名"},model:{value:t.excelName,callback:function(e){t.excelName=e},expression:"excelName"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",disabled:""===t.excelName},on:{click:t.down}},[t._v("下 载")])],1)],1)],1)},n=[];function l(t){return s(t)||i(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function s(t){if(Array.isArray(t)){for(var e=0,a=new Array(t.length);e<t.length;e++)a[e]=t[e];return a}}var c=a("cfd6"),p=c.export_json_to_excel;function u(t,e,r){t[0].planType="1"===t[0].planType?"月计划":"2"===t[0].planType?"年计划":"紧急计划",t[0].planState="1"===t[0].planState?"已计划":"2"===t[0].planState?"已提交汇总":"3"===t[0].planState?"已删除":"自由",t[0].approvalState="1"===t[0].approvalState?"未提交":"2"===t[0].approvalState?"审批通过":"3"===t[0].approvalState?"审批退回":"审批中",t[0].needType="1"===t[0].needType?"订单型":"2"===t[0].needType?"非订单型":"紧急型",console.log(t),Promise.resolve().then(function(){var a=["计划名称","编码","计划类型","制单人","制单时间","计划状态","审批状态","需求类型","采购时间"],n=["procureName","procureId","planType","create","createTime","planState","approvalState","needType","procureTime"],o=d(n,t),i=["物料分类编码","物料分类名称","物料编码","物料名称","规格","型号","单位","需求数量","需求月份","需求日期","货源是否稳定","期望供应商","固定供应商","备注","物料追踪码","所属需求计划编码","供应方式","供应数量","在途库存","可用库存","已占库存","库存总量"],s=["materialClassificationCode","materialClassificationName","materialCode","materialName","specifications","model","company","demandQuantity","demandMonth","demandDate","source","expectedSupplier","fixedSupplier","remarks","materialTrackingCode","planId","supplyType","supplyNum","transport","available","occupy","total"],c=d(s,e);o.push([]),o.push(i),o.push.apply(o,l(c)),console.log(o),p(a,o,r)}.bind(null,a)).catch(a.oe)}function d(t,e){return e.map((function(e){return t.map((function(t){return e[t]}))}))}var m=a("5dd7"),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",{staticStyle:{width:"98%"},attrs:{id:"table-column",data:t.list,"row-key":t.getRowKeys,"expand-row-keys":t.expands},on:{"expand-change":t.expandSelect}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form",{attrs:{"label-width":"100px","label-position":"left"}},[a("el-row",t._l(t.tableHead2,(function(r,n){return a("el-col",{key:n,attrs:{span:8}},[a("el-form-item",{attrs:{label:r.label+":"}},[t._v(" "+t._s(e.row[""+r.prop])+" ")])],1)})),1)],1)]}}])}),a("el-table-column",{attrs:{type:"index",label:"id"}}),t._l(t.tableHead1,(function(t,e){return a("el-table-column",{key:t.prpo,attrs:{label:t.label,prop:t.prop}})}))],2)},v=[],b={props:["list"],data:function(){return{tableHead1:[{label:"物料分类名称",prop:"materialClassificationName"},{label:"物料编码",prop:"materialCode"},{label:"物料名称",prop:"materialName"},{label:"规格",prop:"specifications"},{label:"型号",prop:"model"},{label:"单位",prop:"company"},{label:"需求数量",prop:"demandQuantity"}],tableHead2:[{label:"需求月份",prop:"demandMonth"},{label:"需求日期",prop:"demandDate"},{label:"货源是否稳定",prop:"source"},{label:"期望供应商",prop:"expectedSupplier"},{label:"固定供应商",prop:"fixedSupplier"},{label:"物料追踪码 ",prop:"materialTrackingCode"},{label:"所属需求计划",prop:"planId"},{label:"供应方式",prop:"supplyType"},{label:"供应数量",prop:"supplyNum"},{label:"在途库存",prop:"transport"},{label:"可用库存",prop:"available"},{label:"已占库存",prop:"occupy"},{label:"库存总量",prop:"total"}],expands:[],getRowKeys:function(t){return t.id}}},methods:{expandSelect:function(t,e){var a=this;a.tableId(),e.length?(a.expands=[],t&&a.expands.push(t.id)):a.expands=[]},tableId:function(){for(var t in this.list)this.list[t].id=t}},mounted:function(){},create:function(){}},S=b,g=(a("40a7"),a("2877")),h=Object(g["a"])(S,f,v,!1,null,null,null),y=h.exports,x={name:"materialList",components:{procePlan:m["a"],list:y},data:function(){return{list:[{total:123,procureName:"456",supplyType:"采购",model:"大"},{}],plan:[JSON.parse(sessionStorage.getItem("producePlan"))],dialogVisible:!1,excelName:""}},methods:{down:function(){u(this.plan,this.list,this.excelName),this.dialogVisible=!1}},mounted:function(){var t=this,e={procureId:this.plan[0].procureId};this.$api.getProcureList(e,(function(e){t.list=e.data}))}},_=x,w=Object(g["a"])(_,r,n,!1,null,"46ddadc0",null);e["default"]=w.exports}}]);
//# sourceMappingURL=chunk-3ead2190.bf5af2b3.js.map