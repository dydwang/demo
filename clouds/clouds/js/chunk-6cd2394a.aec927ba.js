(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6cd2394a"],{"0b90":function(e,t,a){"use strict";var r=a("71d7"),n=a.n(r);n.a},"5dd7":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"materialPlan"}},[e.operation?a("title-text",{staticStyle:{"margin-bottom":"20px"},attrs:{text:"采购计划列表",weight:"600",color:"#636569"}}):a("title-text",{staticStyle:{"margin-bottom":"20px"},attrs:{text:"采购计划详情",weight:"600",color:"#636569"}}),a("el-table",{staticStyle:{width:"98%"},attrs:{"row-key":e.getRowKeys,"expand-row-keys":e.expands,data:e.tableData,type:"index"},on:{"expand-change":e.expandSelect}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-row",[a("el-col",{attrs:{span:12}},[a("procurePlanState",{attrs:{procureId:e.row.procureId}})],1),a("el-col",{attrs:{span:10}},[a("procurePlanChangeState",{attrs:{procureId:e.row.procureId}})],1)],1)]}}])}),a("el-table-column",{attrs:{label:"计划名称",prop:"procureName"}}),a("el-table-column",{attrs:{label:"计划编码",prop:"procureId"}}),a("el-table-column",{attrs:{label:"制单人",prop:"create"}}),a("el-table-column",{attrs:{label:"制单时间",prop:"createTime"}}),a("el-table-column",{attrs:{label:"采购时间",prop:"procureTime"}}),a("el-table-column",{attrs:{label:"计划状态",prop:"planState"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.getPlanStateType(t.row.planState),"disable-transitions":""}},[e._v(e._s(e.getPlanState(t.row.planState))+" ")])]}}])}),a("el-table-column",{attrs:{label:"审批状态",prop:"approvalState"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.getPlanStateType(t.row.approvalState),"disable-transitions":""}},[e._v(e._s(e.getApprovalState(t.row.approvalState))+" ")])]}}])}),a("el-table-column",{attrs:{label:"计划类型",prop:"planType"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getPlanType(t.row.planType))+" ")]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.operation?a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.details(t.row)}}},[e._v(" 打印 ")]):e._e(),e.getPower(t.row)?a("span",["1"===t.row.approvalState&&"4"===t.row.planState?a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.goBack(t,"4",null)}}},[e._v(" 提交 ")]):e._e(),"1"===t.row.approvalState||"3"===t.row.approvalState?a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.updates(t.row)}}},[e._v(" 修改 ")]):e._e(),"4"===t.row.approvalState?a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.goBack(t,"1",null)}}},[e._v(" 撤回 ")]):e._e(),"4"===t.row.planState?a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.goBack(t,"1","3")}}},[e._v(" 删除 ")]):e._e()],1):e._e()]}}])})],1)],1)},n=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"card"}},[a("div",{attrs:{id:"title"}},[e._v(" 物资计划修改情况 ")]),a("el-card",[a("el-timeline",{directives:[{name:"show",rawName:"v-show",value:e.activities!==[],expression:"activities!==[]"}]},e._l(e.activities,(function(t,r){return a("el-timeline-item",{key:r,attrs:{placement:"top",icon:"el-icon-more",type:"primary ",timestamp:e.getTime(t.reviseTime)}},[a("span",{staticClass:"title"},[e._v(" "+e._s(t.revise)+"修改物资计划 ")]),a("div",{staticStyle:{color:"#909399","margin-right":"50px","margin-top":"10px"}},[e._v(" "+e._s(t.reviseRemarks)+" ")])])})),1),a("div",{directives:[{name:"show",rawName:"v-show",value:""===e.activities,expression:"activities===''"}],staticClass:"el-icon-s-promotion",staticStyle:{color:"#2ca5ef"}},[e._v("暂无修改情况")])],1)],1)},o=[],c={name:"materialPlanChangeState",props:["procureId"],data:function(){return{activities:[{reviseTime:0xb3a73cf5fad,revise:"李四",reviseRemarks:"很好"},{reviseTime:0xb3a73cf5fad,revise:"李四",reviseRemarks:"很好"}]}},methods:{getTime:function(e){var t=new Date(e),a=t.getFullYear(),r=t.getMonth()+1,n=t.getDate(),l=t.getHours(),o=t.getMinutes(),c=t.getSeconds();return"".concat(a,"-").concat(r,"-").concat(n," ").concat(l,":").concat(o,":").concat(c)}},mounted:function(){var e=this,t={procureId:this.procureId};this.$api.getProcurePlanChangeState(t,(function(t){e.activities=t.data}))}},s=c,i=(a("aea6"),a("2877")),p=Object(i["a"])(s,l,o,!1,null,"1565edbb",null),u=p.exports,d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-timeline",{staticClass:"timeline"},e._l(e.activities,(function(t,r){return a("el-timeline-item",{key:r,attrs:{placement:"top",icon:t.icon,type:t.type,color:e.getColor(r),size:t.size,timestamp:e.approval(r)}},[a("el-card",[a("span",{staticClass:"title"},[e._v(" "+e._s(t.content)+" "),0===r?a("i",{staticClass:"el-icon-success",staticStyle:{color:"#04b3f9"}}):e._e(),e._l(3,(function(t){return t===r?a("span",{key:t},[1===r?a("span",[2===e.materialPlanState[0].headState?a("i",{staticClass:"el-icon-success",staticStyle:{color:"#04b3f9"}}):e._e(),3===e.materialPlanState[0].needState?a("i",{staticClass:"el-icon-error",staticStyle:{color:"#e6a23c"}}):e._e()]):e._e(),2===r?a("span",[2===e.materialPlanState[0].needState?a("i",{staticClass:"el-icon-success",staticStyle:{color:"#04b3f9"}}):e._e(),3===e.materialPlanState[0].needState?a("i",{staticClass:"el-icon-error",staticStyle:{color:"#e6a23c"}}):e._e()]):e._e()]):e._e()})),3===r&&2===e.materialPlanState[0].needState&&2===e.materialPlanState[0].headState?a("i",{staticClass:"el-icon-success",staticStyle:{color:"#04b3f9"}}):e._e()],2),a("p",{staticStyle:{color:"#909399"}},[e._v(" "+e._s(e.getRemarks(r))+" ")])])],1)})),1)},m=[],f={props:["procureId"],data:function(){return{activities:[{content:"创建采购计划",type:"primary",icon:"el-icon-more"},{content:"采购主管审核"},{content:"财务审核"},{content:"审核成功"}],materialPlanState:[{create:"创建人",createTime:12315645,createRemarks:"创建人",approvalHead:"部门主管审核",approvalHeadTime:12354678,headState:2,approvalHeadRemarks:"有问题",approvalNeed:"审核需求计划员",approvalNeedTime:1236457,approvalNeedRemarks:"不错",needState:4,revise:"",reviseTime:12345678,reviseRemarks:"不错不错"}],approvalColor:{succ:"#0bbd87",now:"#e6a23c"},approvalCode:this.$store.state.approvalCode}},methods:{getColor:function(e){var t=this.materialPlanState[0];if(0===e)return"#3692f1";if(1===e){if("2"===t.headState)return this.approvalColor.succ}else if(2===e){if("2"===t.needState)return this.approvalColor.succ}else if(3===e)return"2"===t.needState&&"2"===t.headState?this.approvalColor.succ:""},approval:function(e){var t=this.materialPlanState[0],a=parseInt(t.createTime);return e>this.approvalCode?"":0===e&&null!==t.create?"".concat(this.getTime(a),"   ").concat(t.create):1===e&&null!==t.approvalHead?"".concat(this.getTime(t.approvalHeadTime),"   ").concat(t.approvalHead):2===e&&null!==t.approvalNeed?"".concat(this.getTime(t.approvalNeedTime),"   ").concat(t.approvalNeed):3===e?"":(this.approvalCode=e,"审核中")},getRemarks:function(e){return 0===e?this.materialPlanState.createRemarks:1===e?this.materialPlanState.approvalHeadRemarks:2===e?this.materialPlanState.approvalNeedRemarks:""},getTime:function(e){var t=new Date(parseInt(e)),a=t.getFullYear(),r=t.getMonth()+1,n=t.getDate(),l=t.getHours(),o=t.getMinutes(),c=t.getSeconds();return"".concat(a,"-").concat(r,"-").concat(n," ").concat(l,":").concat(o,":").concat(c)}},mounted:function(){var e=this,t={procureId:this.procureId};this.$api.getProcurePlanState(t,(function(t){e.materialPlanState=t.data}))},create:function(){}},v=f,g=(a("bed8"),Object(i["a"])(v,d,m,!1,null,"9e10fca4",null)),h=g.exports,S={name:"Plan",data:function(){return{reverse:!0,expands:[],getRowKeys:function(e){return e.id}}},props:["operation","tableData"],methods:{getPower:function(e){return"3"!==e.planState&&localStorage.getItem("grade")===this.$constData.grade.procure},getPlanState:function(e){e=parseInt(e);var t="已计划",a="已提交汇总",r="已删除",n="已自由";return 1===e?t:2===e?a:3===e?r:4===e?n:void 0},getApprovalState:function(e){e=parseInt(e);var t="未提交",a="审批通过",r="审批退回",n="审批中";return 1===e?t:2===e?a:3===e?r:4===e?n:void 0},tableId:function(){for(var e in this.tableData)this.tableData[e].id=e},getPlanType:function(e){e=parseInt(e);var t="月计划",a="年计划",r="紧急计划";return 1===e?t:2===e?a:3===e?r:""},expandSelect:function(e,t){this.$store.state.approvalCode=100;var a=this;a.tableId(),t.length?(a.expands=[],e&&a.expands.push(e.id)):a.expands=[]},getPlanStateType:function(e){e=parseInt(e);var t="success",a="info",r="warning";return 1===e?"":2===e?t:3===e?r:4===e?a:void 0},details:function(e){sessionStorage.setItem("producePlan",JSON.stringify(e)),this.$router.push({path:"procurePlanDetails"})},goBack:function(e,t,a){var r=this;this.tableData.splice(e.$index,1);var n={};n.procureId=e.row.procureId,n.approvalState=t,n.planState=null===a?e.row.planState:a,this.$api.procureChangeState(n,(function(n){e.row.approvalState=t,e.row.planState=null===a?e.row.planState:a,r.tableData.splice(e.$index,0,e.row)}))},updates:function(e){sessionStorage.setItem("updateProcurePlan",JSON.stringify(e)),this.$router.push({path:"updateProcure"})}},mounted:function(){},created:function(){},components:{procurePlanChangeState:u,procurePlanState:h}},b=S,P=(a("0b90"),Object(i["a"])(b,r,n,!1,null,"0d55f622",null));t["a"]=P.exports},"71d7":function(e,t,a){},"82f1":function(e,t,a){},a8a1:function(e,t,a){},aea6:function(e,t,a){"use strict";var r=a("a8a1"),n=a.n(r);n.a},b854:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("selectProcure",{ref:"select",on:{select:e.selectTable,change:e.changeCount}}),a("plan",{attrs:{operation:!0,"table-data":e.tableData}}),a("nextPage",{ref:"nextPage",on:{next:e.nextPage}})],1)},n=[],l=a("5dd7"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{width:"90%","margin-left":"5%"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:3}},[a("el-input",{attrs:{placeholder:"输入计划名称"},model:{value:e.selectForm.procureName,callback:function(t){e.$set(e.selectForm,"procureName",t)},expression:"selectForm.procureName"}})],1),a("el-col",{attrs:{span:3}},[a("el-input",{attrs:{placeholder:"输入计划编号"},model:{value:e.selectForm.procureId,callback:function(t){e.$set(e.selectForm,"procureId",t)},expression:"selectForm.procureId"}})],1),a("el-col",{attrs:{span:3}},[a("el-select",{attrs:{placeholder:"请选择计划类型"},model:{value:e.selectForm.planType,callback:function(t){e.$set(e.selectForm,"planType",t)},expression:"selectForm.planType"}},e._l(e.planTypeTable,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1)},c=[],s={name:"selectProcure",data:function(){return{selectForm:{procureName:"",procureId:"",planType:""},month:"",planTypeTable:[{value:"1",label:"月计划"},{value:"2",label:"年计划"},{value:"3",label:"紧急计划"}],options:["财务部","组织部","人事部","策划部","仓库"],change:!1,cnt:{offset:0,count:10}}},methods:{selectProcurePlan:function(e){var t=this,a=JSON.parse(JSON.stringify(this.selectForm));e.procureName=""===a.procureName?"0":a.procureName,e.procureId=""===a.procureId?0:parseInt(a.procureId),e.planType=""===a.planType?"0":a.planType,console.log(e),this.$api.selectProcurePlan(e,(function(e){t.$emit("select",e.data)}))},getProcurePlan:function(e){var t=this;this.$api.getProcurePlan(e,(function(e){console.log(e.data),t.$emit("select",e.data)}))},getPlan:function(e){this.change?(console.log("select"),this.selectProcurePlan(e)):(console.log("get"),this.getProcurePlan(e))}},watch:{select:function(e,t){if(""!==e.procureName&&""!==e.procureId&&""!==e.planType){this.change=!0;var a=this.cnt;this.selectProcurePlan(a)}else{var r=this.cnt;console.log(r),this.getMaterialPlan(r)}this.$emit("change")},deep:!0},computed:{select:function(){return JSON.stringify(this.selectForm)}}},i=s,p=a("2877"),u=Object(p["a"])(i,o,c,!1,null,"1cfc579a",null),d=u.exports,m={name:"procurePlan",components:{plan:l["a"],selectProcure:d},data:function(){return{tableData:[]}},mounted:function(){var e={offset:0,count:10};this.getProcurePlan(e)},methods:{selectTable:function(e){this.$refs.nextPage.judge(e.length),this.tableData=e},changeCount:function(){this.$refs.nextPage.defaultPage()},nextPage:function(e){this.$refs.select.getPlan(e)},getProcurePlan:function(e){var t=this;this.$api.getProcurePlan(e,(function(e){t.$refs.nextPage.judge(e.data.length),t.tableData=e.data}))}}},f=m,v=Object(p["a"])(f,r,n,!1,null,"10d5cfd6",null);t["default"]=v.exports},bed8:function(e,t,a){"use strict";var r=a("82f1"),n=a.n(r);n.a}}]);
//# sourceMappingURL=chunk-6cd2394a.aec927ba.js.map